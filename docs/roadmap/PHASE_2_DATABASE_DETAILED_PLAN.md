# üìã –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –§–∞–∑–∞ 2 - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–°–æ–∑–¥–∞–Ω–æ:** 2025-10-26 (–∞–≥–µ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-10-26 (–¥–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞ 2.7 - —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
**–í–µ—Ä—Å–∏—è:** 1.1.0
**–û—Ü–µ–Ω–∫–∞:** 60-80 —á–∞—Å–æ–≤ —á–∏—Å—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ ‚Üí 12-16 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π

---

## –û–±–∑–æ—Ä –§–∞–∑—ã 2

**–¶–µ–ª—å:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å localStorage –Ω–∞ Supabase (PostgreSQL + Auth + RLS) –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç–æ–π —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:**
- –ü—Ä–æ–µ–∫—Ç –º–µ–Ω—è–µ—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏—é: **–æ—Ç –ª–∏—á–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) –∫ –ø—É–±–ª–∏—á–Ω–æ–º—É (–º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É)**
- –¢–µ–∫—É—â–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ: localStorage + —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GitHub API
- –î–∞–Ω–Ω—ã–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ: –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω—ã–µ —Ü–∏–∫–ª—ã, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –¢—Ä–µ–±—É–µ—Ç—Å—è: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, RLS (Row Level Security), GDPR compliance

**–ü–æ—Å–ª–µ –§–∞–∑—ã 2:**
- –§–∞–∑–∞ 3: AI-–∞–≥–µ–Ω—Ç—ã (–±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å Supabase)
- –§–∞–∑–∞ 4: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- –§–∞–∑–∞ 5: UI

**–°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `/src/utils/storage.ts` - localStorage API (–∑–∞–º–µ–Ω—è–µ–º –Ω–∞ Supabase)
- `/src/utils/cloudSync.ts` - GitHub sync (—É–¥–∞–ª—è–µ–º)
- `/src/types/index.ts` - —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (—Ä–∞—Å—à–∏—Ä—è–µ–º)
- `/src/components/ModernNastiaApp.tsx` - –≥–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–¥–æ–±–∞–≤–ª—è–µ–º auth)

---

## üìù –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø–æ –∑–∞–¥–∞—á–∞–º

### –ó–∞–¥–∞—á–∞ 2.1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase
**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~8-10 —á–∞—Å–æ–≤
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –Ω–µ—Ç

---

#### –®–∞–≥ 2.1.1: –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Supabase (~30 –º–∏–Ω—É—Ç)

- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ https://supabase.com
- [ ] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç: `nastia-calendar-prod`
- [ ] –í—ã–±—Ä–∞—Ç—å —Ä–µ–≥–∏–æ–Ω: Europe (closest to users)
- [ ] –ó–∞–ø–∏—Å–∞—Ç—å Database Password (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ password manager!)
- [ ] –ó–∞–ø–∏—Å–∞—Ç—å Project URL –∏ anon/service keys

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω, –ø–æ–ª—É—á–µ–Ω—ã credentials.

---

#### –®–∞–≥ 2.1.2: –°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –ë–î (~2-3 —á–∞—Å–∞)

- [ ] –û—Ç–∫—Ä—ã—Ç—å SQL Editor –≤ Supabase dashboard
- [ ] –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü (—Å–º. –Ω–∏–∂–µ)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –≤ Table Editor

**SQL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:**

```sql
-- ==============================================================================
-- –¢–∞–±–ª–∏—Ü–∞: users (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ auth.users)
-- ==============================================================================
-- Supabase –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç auth.users –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ Auth
-- –ú—ã —Å–æ–∑–¥–∞—ë–º public.users –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

CREATE TABLE public.users (
  id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,

  -- –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  email TEXT NOT NULL UNIQUE,
  display_name TEXT,

  -- –ê—Å—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å
  astro_profile_id TEXT NOT NULL DEFAULT 'nastia',
  birth_date DATE,
  birth_time TIME,
  birth_place TEXT,

  -- –ù–∞—Å—Ç—Ä–æ–π–∫–∏
  timezone TEXT DEFAULT 'UTC',
  locale TEXT DEFAULT 'ru',

  -- –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
  data_sharing_consent BOOLEAN DEFAULT false,

  -- Timestamps
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_users_email ON public.users(email);
CREATE INDEX idx_users_astro_profile ON public.users(astro_profile_id);

-- RLS: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
ALTER TABLE public.users ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own profile"
  ON public.users
  FOR SELECT
  USING (auth.uid() = id);

CREATE POLICY "Users can update own profile"
  ON public.users
  FOR UPDATE
  USING (auth.uid() = id);

-- ==============================================================================
-- –¢–∞–±–ª–∏—Ü–∞: cycles
-- ==============================================================================
CREATE TABLE public.cycles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE,

  -- –î–∞—Ç—ã
  start_date DATE NOT NULL,
  end_date DATE,

  -- –î–ª–∏–Ω–∞ —Ü–∏–∫–ª–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è)
  cycle_length INTEGER,
  period_length INTEGER,

  -- Metadata
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_cycles_user_id ON public.cycles(user_id);
CREATE INDEX idx_cycles_start_date ON public.cycles(start_date DESC);
CREATE INDEX idx_cycles_user_date ON public.cycles(user_id, start_date DESC);

-- RLS: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ü–∏–∫–ª—ã
ALTER TABLE public.cycles ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own cycles"
  ON public.cycles
  FOR SELECT
  USING (auth.uid() = user_id);

CREATE POLICY "Users can insert own cycles"
  ON public.cycles
  FOR INSERT
  WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own cycles"
  ON public.cycles
  FOR UPDATE
  USING (auth.uid() = user_id);

CREATE POLICY "Users can delete own cycles"
  ON public.cycles
  FOR DELETE
  USING (auth.uid() = user_id);

-- ==============================================================================
-- –¢–∞–±–ª–∏—Ü–∞: day_data (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —Å–∏–º–ø—Ç–æ–º—ã –ø–æ –¥–Ω—è–º)
-- ==============================================================================
CREATE TABLE public.day_data (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE,
  cycle_id UUID REFERENCES public.cycles(id) ON DELETE CASCADE,

  -- –î–∞—Ç–∞
  date DATE NOT NULL,

  -- –î–∞–Ω–Ω—ã–µ –¥–Ω—è
  mood TEXT CHECK (mood IN ('good', 'neutral', 'bad')),
  pain_level INTEGER CHECK (pain_level >= 0 AND pain_level <= 5),
  symptoms TEXT[], -- array of symptoms
  notes TEXT,

  -- Metadata
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  -- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å: –æ–¥–∏–Ω DayData –Ω–∞ –¥–∞—Ç—É –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  UNIQUE(user_id, date)
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_day_data_user_id ON public.day_data(user_id);
CREATE INDEX idx_day_data_date ON public.day_data(date DESC);
CREATE INDEX idx_day_data_cycle_id ON public.day_data(cycle_id);

-- RLS
ALTER TABLE public.day_data ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own day data"
  ON public.day_data
  FOR ALL
  USING (auth.uid() = user_id);

-- ==============================================================================
-- –¢–∞–±–ª–∏—Ü–∞: psychological_profiles
-- ==============================================================================
CREATE TABLE public.psychological_profiles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL UNIQUE REFERENCES public.users(id) ON DELETE CASCADE,

  -- –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (JSON)
  behavior_patterns JSONB DEFAULT '[]'::jsonb,

  -- –ò—Å—Ç–æ—Ä–∏—è –∏—Å—Ç–æ—Ä–∏–π (JSON)
  story_history JSONB DEFAULT '[]'::jsonb,

  -- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Ü–∏–∫–ª ‚Üî –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (JSON)
  cycle_mood_correlations JSONB DEFAULT '[]'::jsonb,

  -- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –∞—Å—Ç—Ä–æ ‚Üî –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ (JSON)
  astro_mood_correlations JSONB DEFAULT '[]'::jsonb,

  -- –ê—Å—Ç—Ä–æ–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
  astro_vulnerabilities TEXT[],

  -- Timestamps –∞–Ω–∞–ª–∏–∑–∞
  last_full_analysis TIMESTAMPTZ,
  last_update TIMESTAMPTZ DEFAULT NOW(),

  -- Metadata
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_psych_profiles_user_id ON public.psychological_profiles(user_id);

-- RLS
ALTER TABLE public.psychological_profiles ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own psych profile"
  ON public.psychological_profiles
  FOR ALL
  USING (auth.uid() = user_id);

-- ==============================================================================
-- –¢–∞–±–ª–∏—Ü–∞: horoscope_memory
-- ==============================================================================
CREATE TABLE public.horoscope_memory (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE,

  -- –î–∞–Ω–Ω—ã–µ –≥–æ—Ä–æ—Å–∫–æ–ø–∞
  date DATE NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('daily', 'weekly')),
  summary TEXT NOT NULL,
  key_themes TEXT[],
  phrases_to_avoid TEXT[],

  -- Metadata
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_horoscope_memory_user_id ON public.horoscope_memory(user_id);
CREATE INDEX idx_horoscope_memory_date ON public.horoscope_memory(date DESC);

-- RLS
ALTER TABLE public.horoscope_memory ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own horoscope memory"
  ON public.horoscope_memory
  FOR ALL
  USING (auth.uid() = user_id);

-- ==============================================================================
-- –¢–∞–±–ª–∏—Ü–∞: psych_contract_history
-- ==============================================================================
CREATE TABLE public.psych_contract_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES public.users(id) ON DELETE CASCADE,

  -- –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
  used_contract_ids TEXT[],
  used_scenario_ids TEXT[],
  scenario_use_counts JSONB DEFAULT '{}'::jsonb,

  -- Metadata
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_psych_contract_history_user_id ON public.psych_contract_history(user_id);

-- RLS
ALTER TABLE public.psych_contract_history ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own contract history"
  ON public.psych_contract_history
  FOR ALL
  USING (auth.uid() = user_id);

-- ==============================================================================
-- –¢–∞–±–ª–∏—Ü–∞: app_settings (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
-- ==============================================================================
CREATE TABLE public.app_settings (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL UNIQUE REFERENCES public.users(id) ON DELETE CASCADE,

  -- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–∏–∫–ª–∞
  average_cycle_length INTEGER DEFAULT 28,
  period_length INTEGER DEFAULT 5,

  -- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  notifications_enabled BOOLEAN DEFAULT true,

  -- Metadata
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- RLS
ALTER TABLE public.app_settings ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own settings"
  ON public.app_settings
  FOR ALL
  USING (auth.uid() = user_id);

-- ==============================================================================
-- –§—É–Ω–∫—Ü–∏–∏ –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã
-- ==============================================================================

-- –§—É–Ω–∫—Ü–∏—è: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä –∫–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º
CREATE TRIGGER update_users_updated_at BEFORE UPDATE ON public.users
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_cycles_updated_at BEFORE UPDATE ON public.cycles
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_day_data_updated_at BEFORE UPDATE ON public.day_data
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_psych_profiles_updated_at BEFORE UPDATE ON public.psychological_profiles
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_psych_contract_history_updated_at BEFORE UPDATE ON public.psych_contract_history
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_app_settings_updated_at BEFORE UPDATE ON public.app_settings
  FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

-- –§—É–Ω–∫—Ü–∏—è: —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
CREATE OR REPLACE FUNCTION handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.users (id, email, display_name)
  VALUES (NEW.id, NEW.email, NEW.raw_user_meta_data->>'display_name');

  INSERT INTO public.app_settings (user_id)
  VALUES (NEW.id);

  INSERT INTO public.psychological_profiles (user_id)
  VALUES (NEW.id);

  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- –¢—Ä–∏–≥–≥–µ—Ä: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION handle_new_user();
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ö–µ–º–∞ –ë–î —Å–æ–∑–¥–∞–Ω–∞, RLS –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —Ç—Ä–∏–≥–≥–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç.

---

#### –®–∞–≥ 2.1.3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ Supabase dashboard (~30 –º–∏–Ω—É—Ç)

- [ ] –ü–µ—Ä–µ–π—Ç–∏ –≤ Authentication ‚Üí Settings
- [ ] –í–∫–ª—é—á–∏—Ç—å Email auth
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Email templates (Welcome, Reset password)
- [ ] –û—Ç–∫–ª—é—á–∏—Ç—å Sign up confirmation (–¥–ª—è MVP) –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å (–¥–ª—è production)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redirect URLs: `http://localhost:3000`, `https://segigu.github.io/nastia-calendar`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Email auth –Ω–∞—Å—Ç—Ä–æ–µ–Ω.

---

#### –®–∞–≥ 2.1.4: –°–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª —Å credentials (~15 –º–∏–Ω—É—Ç)

- [ ] –°–æ–∑–¥–∞—Ç—å `/nastia-simple/.env.local`
- [ ] –î–æ–±–∞–≤–∏—Ç—å Supabase credentials
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ `.gitignore`

**–ü—Ä–∏–º–µ—Ä `.env.local`:**

```bash
# Supabase
REACT_APP_SUPABASE_URL=https://your-project.supabase.co
REACT_APP_SUPABASE_ANON_KEY=your-anon-key

# AI Keys (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
REACT_APP_CLAUDE_API_KEY=...
REACT_APP_OPENAI_API_KEY=...
```

**.gitignore (–¥–æ–±–∞–≤–∏—Ç—å):**

```
# Environment variables
.env.local
.env.development.local
.env.test.local
.env.production.local
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û:** Service Role Key –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ! –¢–æ–ª—å–∫–æ –≤ backend / Edge Functions.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Credentials –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.

---

#### –®–∞–≥ 2.1.5: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase SDK (~15 –º–∏–Ω—É—Ç)

- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `@supabase/supabase-js`
- [ ] –°–æ–∑–¥–∞—Ç—å `/src/lib/supabaseClient.ts`

**–ö–æ–º–∞–Ω–¥–∞:**

```bash
npm install @supabase/supabase-js
```

**–§–∞–π–ª `/src/lib/supabaseClient.ts`:**

```typescript
import { createClient } from '@supabase/supabase-js';

const supabaseUrl = process.env.REACT_APP_SUPABASE_URL!;
const supabaseAnonKey = process.env.REACT_APP_SUPABASE_ANON_KEY!;

if (!supabaseUrl || !supabaseAnonKey) {
  throw new Error('Missing Supabase environment variables');
}

export const supabase = createClient(supabaseUrl, supabaseAnonKey);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Supabase SDK –ø–æ–¥–∫–ª—é—á–µ–Ω.

---

### –ó–∞–¥–∞—á–∞ 2.2: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ UI
**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~10-12 —á–∞—Å–æ–≤
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** 2.1

---

#### –®–∞–≥ 2.2.1: –°–æ–∑–¥–∞—Ç—å AuthModal –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (~3-4 —á–∞—Å–∞)

- [ ] –°–æ–∑–¥–∞—Ç—å `/src/components/AuthModal.tsx`
- [ ] –°–æ–∑–¥–∞—Ç—å `/src/components/AuthModal.module.css`
- [ ] –¢—Ä–∏ —Ä–µ–∂–∏–º–∞: Login, Signup, Reset Password
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º

**–§–∞–π–ª `/src/components/AuthModal.tsx` (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π):**

```typescript
import { useState } from 'react';
import { supabase } from '../lib/supabaseClient';
import styles from './AuthModal.module.css';

type AuthMode = 'login' | 'signup' | 'reset';

interface AuthModalProps {
  isOpen: boolean;
  onClose: () => void;
  onSuccess: () => void;
}

export function AuthModal({ isOpen, onClose, onSuccess }: AuthModalProps) {
  const [mode, setMode] = useState<AuthMode>('login');
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [displayName, setDisplayName] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  if (!isOpen) return null;

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setError(null);

    try {
      if (mode === 'login') {
        const { error } = await supabase.auth.signInWithPassword({
          email,
          password,
        });
        if (error) throw error;
        onSuccess();
      } else if (mode === 'signup') {
        const { error } = await supabase.auth.signUp({
          email,
          password,
          options: {
            data: {
              display_name: displayName || email.split('@')[0],
            },
          },
        });
        if (error) throw error;
        alert('–ü—Ä–æ–≤–µ—Ä—å email –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏!');
        setMode('login');
      } else if (mode === 'reset') {
        const { error } = await supabase.auth.resetPasswordForEmail(email);
        if (error) throw error;
        alert('–°—Å—ã–ª–∫–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ email!');
        setMode('login');
      }
    } catch (err: any) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className={styles.overlay} onClick={onClose}>
      <div className={styles.modal} onClick={(e) => e.stopPropagation()}>
        <button className={styles.closeButton} onClick={onClose}>
          √ó
        </button>

        <h2 className={styles.title}>
          {mode === 'login' && '–í—Ö–æ–¥'}
          {mode === 'signup' && '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è'}
          {mode === 'reset' && '–°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è'}
        </h2>

        <form onSubmit={handleSubmit} className={styles.form}>
          {mode === 'signup' && (
            <input
              type="text"
              placeholder="–ò–º—è"
              value={displayName}
              onChange={(e) => setDisplayName(e.target.value)}
              className={styles.input}
            />
          )}

          <input
            type="email"
            placeholder="Email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            required
            className={styles.input}
          />

          {mode !== 'reset' && (
            <input
              type="password"
              placeholder="–ü–∞—Ä–æ–ª—å"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              required
              minLength={6}
              className={styles.input}
            />
          )}

          {error && <div className={styles.error}>{error}</div>}

          <button
            type="submit"
            disabled={loading}
            className={styles.submitButton}
          >
            {loading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : mode === 'login' ? '–í–æ–π—Ç–∏' : mode === 'signup' ? '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è' : '–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É'}
          </button>
        </form>

        <div className={styles.links}>
          {mode === 'login' && (
            <>
              <button onClick={() => setMode('signup')} className={styles.link}>
                –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
              </button>
              <button onClick={() => setMode('reset')} className={styles.link}>
                –ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å?
              </button>
            </>
          )}
          {mode === 'signup' && (
            <button onClick={() => setMode('login')} className={styles.link}>
              –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏
            </button>
          )}
          {mode === 'reset' && (
            <button onClick={() => setMode('login')} className={styles.link}>
              –í—Å–ø–æ–º–Ω–∏–ª –ø–∞—Ä–æ–ª—å? –í–æ–π—Ç–∏
            </button>
          )}
        </div>
      </div>
    </div>
  );
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç.

---

*(–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ—Ö—Ä–∞–Ω—è—é –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)*

---

### –ó–∞–¥–∞—á–∞ 2.7: –ú–∏–≥—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (Edge Functions)
**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ~20-30 —á–∞—Å–æ–≤
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** 2.1, 2.2
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ **—Ç–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç** (—Ç–æ–ª—å–∫–æ UI –≤ –±—Ä–∞—É–∑–µ—Ä–µ) + **—Ç–æ–ª—Å—Ç—ã–π —Å–µ—Ä–≤–µ—Ä** (–≤—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ Edge Functions). –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- üîí API –∫–ª—é—á–∏ Claude/OpenAI —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- üìä –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –≤–µ—Ä—Å–∏—é)
- üí∞ –ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏ AI –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚ö° –¢—è–∂—ë–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞ –º–æ—â–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

**Trade-off:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç offline (—ç—Ç–æ ok, —Ç–µ–∫—É—â–∞—è GitHub sync —Ç–æ–∂–µ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç).

---

#### –®–∞–≥ 2.7.1: –°–æ–∑–¥–∞—Ç—å Edge Function –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Ü–∏–∫–ª–æ–≤ (~6-8 —á–∞—Å–æ–≤)

- [ ] –°–æ–∑–¥–∞—Ç—å `/supabase/functions/calculate-cycle/index.ts`
- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –∏–∑ `cycleUtils.ts`
- [ ] –î–æ–±–∞–≤–∏—Ç—å RLS –ø—Ä–æ–≤–µ—Ä–∫—É (user –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ü–∏–∫–ª—ã)
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã

**–§–∞–π–ª `/supabase/functions/calculate-cycle/index.ts`:**

```typescript
import { serve } from 'https://deno.land/std@0.168.0/http/server.ts'
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

// –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ cycleUtils.ts
function calculateAverageCycleLength(cycles: any[]): number {
  if (cycles.length < 2) return 28;
  const lengths = cycles
    .filter(c => c.cycle_length && c.cycle_length >= 21 && c.cycle_length <= 45)
    .map(c => c.cycle_length);
  if (lengths.length === 0) return 28;
  return Math.round(lengths.reduce((a, b) => a + b, 0) / lengths.length);
}

function predictNextPeriod(cycles: any[], avgLength: number) {
  if (cycles.length === 0) return null;
  const lastCycle = cycles[cycles.length - 1];
  const lastDate = new Date(lastCycle.start_date);
  const nextDate = new Date(lastDate);
  nextDate.setDate(nextDate.getDate() + avgLength);
  return nextDate.toISOString().split('T')[0];
}

serve(async (req) => {
  try {
    // Auth check
    const authHeader = req.headers.get('Authorization')!
    const supabase = createClient(
      Deno.env.get('SUPABASE_URL') ?? '',
      Deno.env.get('SUPABASE_ANON_KEY') ?? '',
      { global: { headers: { Authorization: authHeader } } }
    )

    const { data: { user } } = await supabase.auth.getUser()
    if (!user) {
      return new Response('Unauthorized', { status: 401 })
    }

    // Fetch cycles (RLS –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ user_id)
    const { data: cycles, error } = await supabase
      .from('cycles')
      .select('*')
      .order('start_date', { ascending: true })

    if (error) throw error

    // Calculate stats
    const avgLength = calculateAverageCycleLength(cycles)
    const nextPeriod = predictNextPeriod(cycles, avgLength)

    return new Response(
      JSON.stringify({
        avgLength,
        nextPeriod,
        totalCycles: cycles.length
      }),
      { headers: { 'Content-Type': 'application/json' } }
    )
  } catch (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      status: 500,
      headers: { 'Content-Type': 'application/json' },
    })
  }
})
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Edge Function –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ —Ü–∏–∫–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç, RLS –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö.

---

#### –®–∞–≥ 2.7.2: –°–æ–∑–¥–∞—Ç—å Edge Function –¥–ª—è AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (~8-10 —á–∞—Å–æ–≤)

- [ ] –°–æ–∑–¥–∞—Ç—å `/supabase/functions/generate-ai-content/index.ts`
- [ ] –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `aiClient.ts` (–∑–∞–ø—Ä–æ—Å—ã –∫ Claude/OpenAI)
- [ ] –•—Ä–∞–Ω–∏—Ç—å API –∫–ª—é—á–∏ –≤ Supabase Secrets (–Ω–µ –≤ .env –∫–ª–∏–µ–Ω—Ç–∞!)
- [ ] –õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (rate limiting)

**–§–∞–π–ª `/supabase/functions/generate-ai-content/index.ts`:**

```typescript
import { serve } from 'https://deno.land/std@0.168.0/http/server.ts'
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

// Secrets: CLAUDE_API_KEY, OPENAI_API_KEY (—á–µ—Ä–µ–∑ Supabase CLI)
const CLAUDE_KEY = Deno.env.get('CLAUDE_API_KEY')
const OPENAI_KEY = Deno.env.get('OPENAI_API_KEY')

async function callClaude(prompt: string): Promise<string> {
  const response = await fetch('https://api.anthropic.com/v1/messages', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'x-api-key': CLAUDE_KEY!,
      'anthropic-version': '2023-06-01'
    },
    body: JSON.stringify({
      model: 'claude-haiku-4-5',
      max_tokens: 1024,
      messages: [{ role: 'user', content: prompt }]
    })
  })
  const data = await response.json()
  return data.content[0].text
}

serve(async (req) => {
  try {
    const authHeader = req.headers.get('Authorization')!
    const supabase = createClient(
      Deno.env.get('SUPABASE_URL') ?? '',
      Deno.env.get('SUPABASE_ANON_KEY') ?? '',
      { global: { headers: { Authorization: authHeader } } }
    )

    const { data: { user } } = await supabase.auth.getUser()
    if (!user) return new Response('Unauthorized', { status: 401 })

    // Rate limiting: max 10 requests per hour per user
    const { count } = await supabase
      .from('ai_requests')
      .select('*', { count: 'exact', head: true })
      .eq('user_id', user.id)
      .gte('created_at', new Date(Date.now() - 3600000).toISOString())

    if (count && count >= 10) {
      return new Response(
        JSON.stringify({ error: 'Rate limit exceeded (10/hour)' }),
        { status: 429 }
      )
    }

    // Parse request
    const { type, prompt } = await req.json()

    // Generate content
    let content: string
    if (type === 'horoscope' || type === 'story') {
      content = await callClaude(prompt)
    } else {
      throw new Error('Invalid type')
    }

    // Log request
    await supabase.from('ai_requests').insert({
      user_id: user.id,
      type,
      tokens_used: content.length // –ø—Ä–∏–º–µ—Ä–Ω–∞—è –æ—Ü–µ–Ω–∫–∞
    })

    return new Response(JSON.stringify({ content }), {
      headers: { 'Content-Type': 'application/json' }
    })
  } catch (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      status: 500,
      headers: { 'Content-Type': 'application/json' }
    })
  }
})
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, API –∫–ª—é—á–∏ –∑–∞—â–∏—â–µ–Ω—ã, –µ—Å—Ç—å rate limiting.

---

#### –®–∞–≥ 2.7.3: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∏–µ–Ω—Ç–∞ - —Å–æ–∑–¥–∞—Ç—å API —Å–ª–æ–π (~4-6 —á–∞—Å–æ–≤)

- [ ] –°–æ–∑–¥–∞—Ç—å `/src/utils/api.ts` —Å fetch –æ–±—ë—Ä—Ç–∫–∞–º–∏
- [ ] –£–¥–∞–ª–∏—Ç—å `cycleUtils.ts` (–ª–æ–≥–∏–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
- [ ] –£–¥–∞–ª–∏—Ç—å `aiClient.ts` (–∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Edge Function)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

**–§–∞–π–ª `/src/utils/api.ts`:**

```typescript
import { supabase } from './supabaseClient'

export async function fetchCycleStats() {
  const { data, error } = await supabase.functions.invoke('calculate-cycle')
  if (error) throw error
  return data
}

export async function generateAIContent(type: 'horoscope' | 'story', prompt: string) {
  const { data, error } = await supabase.functions.invoke('generate-ai-content', {
    body: { type, prompt }
  })
  if (error) throw error
  return data.content
}
```

**–í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö (–ø—Ä–∏–º–µ—Ä ModernNastiaApp.tsx):**

```typescript
// –ë—ã–ª–æ:
import { calculateAverageCycleLength } from '../utils/cycleUtils'
const avgLength = calculateAverageCycleLength(cycles)

// –°—Ç–∞–ª–æ:
import { fetchCycleStats } from '../utils/api'
const { avgLength, nextPeriod } = await fetchCycleStats()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–ª–∏–µ–Ω—Ç —Å—Ç–∞–ª —Ç–æ–Ω–∫–∏–º, –≤—Å—è –ª–æ–≥–∏–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

---

#### –®–∞–≥ 2.7.4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Edge Functions –ª–æ–∫–∞–ª—å–Ω–æ (~2-3 —á–∞—Å–∞)

- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase CLI: `brew install supabase/tap/supabase`
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ: `supabase start`
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏: `supabase functions serve`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rate limiting, RLS, –æ—à–∏–±–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Edge Functions —Ä–∞–±–æ—Ç–∞—é—Ç –ª–æ–∫–∞–ª—å–Ω–æ, –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç.

---

#### –®–∞–≥ 2.7.5: –î–µ–ø–ª–æ–π Edge Functions –≤ production (~1-2 —á–∞—Å–∞)

- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã: `supabase secrets set CLAUDE_API_KEY=...`
- [ ] –î–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–π: `supabase functions deploy calculate-cycle`
- [ ] –î–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–π: `supabase functions deploy generate-ai-content`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ production

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Edge Functions –∑–∞–¥–µ–ø–ª–æ–µ–Ω—ã, —Ä–∞–±–æ—Ç–∞—é—Ç –≤ production.

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

### –†–∏—Å–∫ 1: –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–Ω–æ–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑ localStorage –≤ Supabase –º–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ù–∞—Å—Ç–∏ (—Ü–∏–∫–ª—ã, –≥–æ—Ä–æ—Å–∫–æ–ø—ã, –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å).

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é localStorage –î–û –º–∏–≥—Ä–∞—Ü–∏–∏ (export –≤ JSON)
2. –ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å dry-run —Ä–µ–∂–∏–º–æ–º (–ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∑–∞–ø–∏—Å–∏ –≤ –ë–î)
3. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å—Ä–∞–≤–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π)
4. –û—Ç–∫–∞—Ç: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å localStorage backup, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

---

### –†–∏—Å–∫ 2: –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ RLS
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è
**–í–ª–∏—è–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–Ω–æ–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ RLS policies ‚Üí user A –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ user B.

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
1. –¢—â–∞—Ç–µ–ª—å–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å RLS (—Å–º. –ó–∞–¥–∞—á–∞ 2.5.3)
2. –ó–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã —Å 2+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
3. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Service Role Key –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
4. –ö–æ–¥ review –≤—Å–µ—Ö RLS policies

---

### –†–∏—Å–∫ 3: –°–ª–æ–º–∞–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–æ–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** Auth –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –≤–æ–π—Ç–∏ ‚Üí –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ—é–∑–∞–±–µ–ª—å–Ω–æ.

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å auth –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º Supabase –ø—Ä–æ–µ–∫—Ç–µ –î–û production
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å fallback: –µ—Å–ª–∏ Supabase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ auth (Supabase logs)
4. E2E —Ç–µ—Å—Ç—ã –¥–ª—è login/signup/logout

---

### –†–∏—Å–∫ 4: –ú–µ–¥–ª–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (UX —Å—Ç—Ä–∞–¥–∞–µ—Ç)
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ó–∞–ø—Ä–æ—Å—ã –≤ Supabase –º–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º localStorage ‚Üí –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–æ—Ä–º–æ–∑–∏—Ç.

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ –≤—Å–µ—Ö —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –ø–æ–ª—è—Ö
2. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (React Query / SWR)
3. Lazy loading: –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤: select —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è

---

### –†–∏—Å–∫ 5: Service Role Key —É—Ç–µ—á—ë—Ç –≤ GitHub
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–Ω–æ–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ Service Role Key –ø–æ–ø–∞–¥—ë—Ç –≤ .env –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ GitHub ‚Üí –ª—é–±–æ–π —Å–º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –ë–î.

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
1. –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Service Role Key –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
2. –î–æ–±–∞–≤–∏—Ç—å .env.local –≤ .gitignore
3. GitHub Secret Scanning (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ—Ç–µ–∫—Ç–∏—Ç –∫–ª—é—á–∏)
4. –ï—Å–ª–∏ –∫–ª—é—á —É—Ç—ë–∫ ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –≤ Supabase dashboard

---

### –†–∏—Å–∫ 6: GDPR compliance –Ω–∞—Ä—É—à–µ–Ω
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è (–µ—Å–ª–∏ –Ω–µ —É—á–µ—Å—Ç—å)
**–í–ª–∏—è–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–Ω–æ–µ (—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–µ–∑ Privacy Policy –∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ ‚Üí –Ω–∞—Ä—É—à–µ–Ω–∏–µ GDPR (—à—Ç—Ä–∞—Ñ—ã –¥–æ 4% –≥–æ–¥–æ–≤–æ–≥–æ –æ–±–æ—Ä–æ—Ç–∞).

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å Privacy Policy (–∑–∞–¥–∞—á–∞ 2.5.1)
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å "Delete my account" (–∑–∞–¥–∞—á–∞ 2.5.2)
3. –î–æ–±–∞–≤–∏—Ç—å —á–µ–∫–±–æ–∫—Å —Å–æ–≥–ª–∞—Å–∏—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
4. –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 60-80 —á–∞—Å–æ–≤ —á–∏—Å—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
**–†–∞–±–æ—á–∏—Ö –¥–Ω–µ–π:** 12-16 –¥–Ω–µ–π –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á:** 7 –æ—Å–Ω–æ–≤–Ω—ã—Ö (2.1-2.7)
**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—à–∞–≥–æ–≤:** 30+

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å:** 2.1 ‚Üí 2.2 ‚Üí 2.7 ‚Üí 2.3 ‚Üí 2.4/2.5/2.6 (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (—Ä–∞–±–æ—Ç–∞ —Å –ë–î, auth, security, –º–∏–≥—Ä–∞—Ü–∏—è + —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

**‚ö†Ô∏è –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (2025-10-26):** –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞ 2.7 (–º–∏–≥—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –Ω–∞ Edge Functions) - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å SPA –Ω–∞ —Ç–æ–Ω–∫–∏–π –∫–ª–∏–µ–Ω—Ç. –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –Ω–∞ +20-30 —á–∞—Å–æ–≤, –Ω–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API –∫–ª—é—á–µ–π –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—é –ª–æ–≥–∏–∫–∏.

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ù–∞—á–∏–Ω–∞–π —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ Supabase –ø—Ä–æ–µ–∫—Ç–∞** - –Ω–µ –¥–µ–ª–∞–π —Å—Ä–∞–∑—É –≤ production, —Ç–µ—Å—Ç–∏—Ä—É–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ
2. **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö - –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å** - —Å–Ω–∞—á–∞–ª–∞ —É–±–µ–¥–∏—Å—å, —á—Ç–æ auth —Ä–∞–±–æ—Ç–∞–µ—Ç
3. **–¢–µ—Å—Ç–∏—Ä—É–π RLS policies –≤—Ä—É—á–Ω—É—é** - —Å–æ–∑–¥–∞–π 2+ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ –ø–æ–ø—Ä–æ–±—É–π –ø—Ä–æ—á–∏—Ç–∞—Ç—å —á—É–∂–∏–µ –¥–∞–Ω–Ω—ã–µ
4. **–ò—Å–ø–æ–ª—å–∑—É–π Supabase Realtime** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
5. **Backup localStorage –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π** - –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
6. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π Service Role Key –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ** - —ç—Ç–æ —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞
7. **–õ–æ–≥–∏—Ä—É–π –≤—Å—ë** - Supabase logs –ø–æ–º–æ–≥—É—Ç –¥–µ–±–∞–∂–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
8. **GDPR compliance —Å –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è** - –ø—Ä–æ—â–µ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–∑—É, —á–µ–º –ø–µ—Ä–µ–¥–µ–ª—ã–≤–∞—Ç—å –ø–æ—Ç–æ–º

---

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

### –ü–æ–¥—Ö–æ–¥ A: Supabase (–≤—ã–±—Ä–∞–Ω)

**–ü–ª—é—Å—ã:**
- ‚úÖ Auth –∏–∑ –∫–æ—Ä–æ–±–∫–∏ (Email, OAuth, Magic Links)
- ‚úÖ RLS (Row Level Security) –¥–ª—è –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Realtime subscriptions
- ‚úÖ Edge Functions –¥–ª—è serverless –ª–æ–≥–∏–∫–∏
- ‚úÖ Storage –¥–ª—è —Ñ–∞–π–ª–æ–≤
- ‚úÖ Free tier –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ (500MB –±–∞–∑–∞, 5GB bandwidth)
- ‚úÖ –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ community

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è Vendor lock-in (–µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å - —Å–ª–æ–∂–Ω–æ)
- ‚ö†Ô∏è Free tier –æ–≥—Ä–∞–Ω–∏—á–µ–Ω (2 –ø—Ä–æ–µ–∫—Ç–∞, –ø—Ä–æ–µ–∫—Ç—ã –∑–∞—Å—ã–ø–∞—é—Ç)
- ‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ Supabase (–Ω–µ self-hosted)

**–í—Ä–µ–º—è:** 40-50 —á–∞—Å–æ–≤

---

### –ü–æ–¥—Ö–æ–¥ B: Firebase

**–ü–ª—é—Å—ã:**
- ‚úÖ Auth –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ Firestore (NoSQL) - –ø—Ä–æ—â–µ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞–µ–≤
- ‚úÖ Firebase Cloud Functions
- ‚úÖ Firebase Hosting

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç Row Level Security (–Ω—É–∂–Ω—ã Security Rules - —Å–ª–æ–∂–Ω–µ–µ)
- ‚ùå NoSQL (Firestore) vs SQL (PostgreSQL) - –¥–ª—è –Ω–∞—à–µ–≥–æ —Å–ª—É—á–∞—è SQL –ª—É—á—à–µ
- ‚ùå –ë–æ–ª–µ–µ –¥–æ—Ä–æ–≥–æ–π scaling

**–ü–æ—á–µ–º—É –ù–ï –≤—ã–±—Ä–∞–Ω:** RLS –≤ Supabase –Ω–∞–º–Ω–æ–≥–æ –ª—É—á—à–µ –¥–ª—è –∑–∞—â–∏—Ç—ã —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. PostgreSQL —É–¥–æ–±–Ω–µ–µ –¥–ª—è structured data (—Ü–∏–∫–ª—ã, –¥–∞—Ç—ã, –∏ —Ç.–¥.).

---

### –ü–æ–¥—Ö–æ–¥ C: Self-hosted PostgreSQL + Auth0

**–ü–ª—é—Å—ã:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å (—Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä, —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ PostgreSQL –º–æ—â–Ω–µ–µ (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, —Ñ—É–Ω–∫—Ü–∏–∏)
- ‚úÖ Auth0 - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å VPS (Digital Ocean, AWS)
- ‚ùå –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å Postgres, nginx, SSL, backup
- ‚ùå –ù—É–∂–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å
- ‚ùå Auth0 –ø–ª–∞—Ç–Ω—ã–π ($23/–º–µ—Å—è—Ü –¥–ª—è production)
- ‚ùå –ù–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ (~2-3 –Ω–µ–¥–µ–ª–∏ –≤–º–µ—Å—Ç–æ 8-10 –¥–Ω–µ–π)

**–ü–æ—á–µ–º—É –ù–ï –≤—ã–±—Ä–∞–Ω:** –û–≤–µ—Ä–∫–∏–ª–ª –¥–ª—è MVP. Supabase –¥–∞—ë—Ç —Ç–µ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

---

### –ü–æ–¥—Ö–æ–¥ D: –û—Å—Ç–∞—Ç—å—Å—è –Ω–∞ localStorage + GitHub sync

**–ü–ª—é—Å—ã:**
- ‚úÖ –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ $0 —Å—Ç–æ–∏–º–æ—Å—Ç—å
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º
- ‚ùå –ù–µ–ª—å–∑—è –¥–∞—Ç—å –¥–æ—Å—Ç—É–ø –¥—Ä—É–∑—å—è–º
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚ùå –ù–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ü–æ—á–µ–º—É –ù–ï –≤—ã–±—Ä–∞–Ω:** –ù–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–≤–æ–π —Ü–µ–ª–∏ - —Å–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω–æ–µ –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ (Definition of Done)

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –§–∞–∑—ã 2:

- [ ] Supabase –ø—Ä–æ–µ–∫—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω (—Ç–∞–±–ª–∏—Ü—ã, RLS, auth)
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (login, signup, logout)
- [ ] storage.ts –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ storageSupabase.ts
- [ ] –î–∞–Ω–Ω—ã–µ –ù–∞—Å—Ç–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –∏–∑ localStorage –≤ Supabase
- [ ] –°—Ç–∞—Ä–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GitHub —É–¥–∞–ª–µ–Ω–∞
- [ ] Privacy Policy —Å–æ–∑–¥–∞–Ω –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ UI
- [ ] –ö–Ω–æ–ø–∫–∞ "Delete my account" —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã (user A –Ω–µ –≤–∏–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ user B)
- [ ] E2E —Ç–µ—Å—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ù–µ—Ç console.error / warnings
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (CLAUDE.md, TECHNICAL_DOCS.md)

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–≤–µ—Ä—à–∏—Ç—å –§–∞–∑—É 1** (—É–Ω–∏–≤–µ—Ä—Å–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞) - 2-3 –¥–Ω—è
2. **–ù–∞—á–∞—Ç—å –§–∞–∑—É 2** (–ë–î + Auth) –ø–æ —ç—Ç–æ–º—É –ø–ª–∞–Ω—É - 8-10 –¥–Ω–µ–π
3. **–ü–æ—Å–ª–µ –§–∞–∑—ã 2:** –ü–µ—Ä–µ–π—Ç–∏ –∫ –§–∞–∑–µ 3 (AI-–∞–≥–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å Supabase)

**–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `/continue` - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏
- `/next` - –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–µ
- `/status` - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ—Ç –ø–ª–∞–Ω —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∞–≥–µ–Ω—Ç–æ–º –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞. –ü–ª–∞–Ω –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã SQL, React –∫–æ–¥–∞, –∞–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å –∑–∞–¥–∞—á–∏ 2.1 (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase) –ü–û–°–õ–ï –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –§–∞–∑—ã 1.
